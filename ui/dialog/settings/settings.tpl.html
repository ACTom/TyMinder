<div class="modal-header settings-modal-header">
    <h3 class="modal-title">{{ 'title' | lang: 'ui/dialog/settings'}}</h3>
</div>
<div class="modal-body settings-modal-body">
    <!-- 语言设置 -->
    <div class="settings-section">
        <h4 class="settings-section-title">{{ 'language' | lang: 'ui'}}</h4>
        <div class="settings-section-content">
            <div class="dropdown" uib-dropdown style="display: inline-block;">
                <button class="btn btn-default dropdown-toggle" uib-dropdown-toggle>
                    {{ getLangLabel(settings.lang) }}
                    <span class="caret"></span>
                </button>
                <ul class="dropdown-menu">
                    <li><a href ng-click="selectLang('system')">{{ 'systemlanguage' | lang: 'ui' }}</a></li>
                    <li class="divider"></li>
                    <li ng-repeat="lang in supportedLangs">
                        <a href ng-click="selectLang(lang.key)">{{lang.label}}</a>
                    </li>
                </ul>
            </div>
        </div>
    </div>
    
    <!-- 主题色设置 -->
    <div class="settings-section">
        <h4 class="settings-section-title">{{ 'themecolor' | lang: 'ui/dialog/settings'}}</h4>
        <div class="settings-section-content">
            <div class="theme-color-grid">
                <div class="theme-color-item" 
                     ng-repeat="colorObj in themeColors" 
                     ng-click="selectThemeColor(colorObj)"
                     ng-class="{'selected': isColorSelected(colorObj)}"
                     ng-style="{'background-color': colorObj.color}"
                     title="{{colorObj.name}}">
                    <span class="glyphicon glyphicon-ok" ng-show="isColorSelected(colorObj)"></span>
                </div>
            </div>
        </div>
    </div>
    
    <!-- 自动备份设置 -->
    <div class="settings-section">
        <h4 class="settings-section-title">{{ 'autobackup' | lang: 'ui/dialog/settings'}}</h4>
        <div class="settings-section-content">
            <div class="settings-row">
                <label class="settings-checkbox">
                    <input type="checkbox" ng-model="settings.autoBackup">
                    <span>{{ 'enableautobackup' | lang: 'ui/dialog/settings'}}</span>
                </label>
            </div>
            <div class="settings-row" ng-show="settings.autoBackup">
                <label>{{ 'backupinterval' | lang: 'ui/dialog/settings'}}</label>
                <select ng-model="settings.backupInterval" class="form-control settings-select">
                    <option value="1">1 {{ 'minute' | lang: 'ui/dialog/settings'}}</option>
                    <option value="3">3 {{ 'minutes' | lang: 'ui/dialog/settings'}}</option>
                    <option value="5">5 {{ 'minutes' | lang: 'ui/dialog/settings'}}</option>
                    <option value="10">10 {{ 'minutes' | lang: 'ui/dialog/settings'}}</option>
                    <option value="15">15 {{ 'minutes' | lang: 'ui/dialog/settings'}}</option>
                    <option value="30">30 {{ 'minutes' | lang: 'ui/dialog/settings'}}</option>
                </select>
            </div>
            <div class="settings-row" ng-show="settings.autoBackup">
                <label class="settings-checkbox">
                    <input type="checkbox" ng-model="settings.deleteBackupOnSave">
                    <span>{{ 'deletebackuponsave' | lang: 'ui/dialog/settings'}}</span>
                </label>
            </div>
            <div class="settings-row backup-info" ng-show="settings.autoBackup">
                <span>{{ 'backupsize' | lang: 'ui/dialog/settings'}}</span>
                <span class="backup-size-value" ng-click="openBackupDir()" title="{{ 'clicktoopenbackupdir' | lang: 'ui/dialog/settings'}}">{{ backupSizeDisplay }}</span>
            </div>
        </div>
    </div>
</div>
<div class="modal-footer">
    <button class="btn btn-primary" ng-click="save()">{{ 'ok' | lang: 'ui/dialog/settings'}}</button>
    <button class="btn btn-default" ng-click="cancel()">{{ 'cancel' | lang: 'ui/dialog/settings'}}</button>
</div>

<style>
.settings-modal-header {
    background-color: var(--theme-color, #fc8383);
    color: white;
    border-radius: 5px 5px 0 0;
}

.settings-modal-header .modal-title {
    font-weight: normal;
}

.settings-modal-body {
    padding: 20px 30px;
}

.settings-section {
    margin-bottom: 25px;
}

.settings-section-title {
    font-size: 14px;
    font-weight: 600;
    color: #555;
    margin-bottom: 12px;
    padding-bottom: 8px;
    border-bottom: 1px solid #eee;
}

.settings-section-content {
    padding-left: 5px;
}

.settings-row {
    margin-bottom: 12px;
    display: flex;
    align-items: center;
    gap: 10px;
}

.settings-checkbox {
    display: flex;
    align-items: center;
    cursor: pointer;
    margin: 0;
    font-weight: normal;
}

.settings-checkbox input[type="checkbox"] {
    margin-right: 8px;
    width: 16px;
    height: 16px;
    cursor: pointer;
}

.settings-select {
    width: auto;
    min-width: 120px;
    display: inline-block;
}

.backup-info {
    font-size: 13px;
    color: #666;
}

.backup-size-value {
    color: var(--theme-color, #fc8383);
    cursor: pointer;
    text-decoration: underline;
}

.backup-size-value:hover {
    color: var(--theme-color-hover, #e77070);
}

.theme-color-grid {
    display: grid;
    grid-template-columns: repeat(8, 36px);
    gap: 8px;
}

.theme-color-item {
    width: 36px;
    height: 36px;
    border-radius: 4px;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: transform 0.15s, box-shadow 0.15s;
    border: 2px solid transparent;
}

.theme-color-item:hover {
    transform: scale(1.1);
    box-shadow: 0 2px 8px rgba(0,0,0,0.2);
}

.theme-color-item.selected {
    border-color: #333;
    box-shadow: 0 0 0 2px white, 0 0 0 4px #333;
}

.theme-color-item .glyphicon {
    color: white;
    font-size: 14px;
    text-shadow: 0 1px 2px rgba(0,0,0,0.3);
}
</style>
